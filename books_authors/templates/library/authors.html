{% extends "base.html" %}
{% load staticfiles crispy_forms_tags %}

{% block content %}
    <div class="row" ng-controller="authorsCtrl">
        <div class="col-md-4 col-md-offset-4">
            <h4 class="text-center page-header">List of all authors</h4>

            <table class="table">
                <thead>
                <tr>
                    <td>#</td>
                    <td>Name</td>
                    {% if user.is_staff %}
                        <td>Admin actions:</td>
                    {% endif %}
                </tr>
                </thead>
                <tbody class="table-stripped">
                <tr ng-repeat="author in authors">
                    {% verbatim %}
                    <td>
                        {{$index + 1}}
                    </td>
                    <td>
                        {{ author.name }}
                    </td>
                    {% endverbatim %}
                    {% if user.is_staff %}
                        <td>
                            <a href="#" style="color: grey; padding-right: 5px"
                               ng-click="toggleEditForm(true, $index, author)">Edit</a>
                            <a href="#" ng-click="deleteAuthor($index, author)">Delete</a>
                        </td>
                    {% endif %}
                </tr>
                </tbody>
            </table>

        </div>
        {% if user.is_staff %}
        <div class="col-md-2 col-md-offset-2">
            <h4 class="text-center page-header">Admin tools:</h4>
            {% block author_form %}
                <form name="add_author_form" novalidate>

                    <div class="form-group">
                        <label class="control-label" for="id_name">Name</label>
                        <input type="text" maxlength="20" id="id_name" class="form-control" name="name" ng-model="name"
                               required>
                    </div>

                    <div class="form-group">
                        <label class="control-label" for="id_slug">Slug</label>
                        <input type="text" maxlength="50" id="id_slug" class="form-control" name="slug" ng-model="slug"
                               required>
                    </div>

                    <div class="form-group">
                        <input ng-show="formEditState" type="submit" class="btn btn-primary btn-block"
                               value="Edit this author"
                               ng-disabled="add_author_form.$invalid" ng-click="editAuthor()">
                    </div>
                    <div class="form-group">
                        <input ng-show="formEditState" type="submit" class="btn btn-info btn-xs btn-block"
                               value="Switch to Adding new author"
                               ng-disabled="add_author_form.$invalid" ng-click="toggleEditForm(false)">

                        <input ng-hide="formEditState" type="submit" class="btn btn-primary btn-block"
                               value="Add new author"
                           ng-disabled="add_author_form.$invalid" ng-click="addAuthor()">
                    </div>
                </form>
            {% endblock author_form %}
        </div>
        {% endif %}
    </div>
{% endblock content %}
